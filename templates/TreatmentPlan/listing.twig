{% extends "base.html.twig" %}
{% block body %}

    <main id="main">
        <section id="about" class="about">
            <a href="{{ path('treatment_create') }}" class="btn btn-primary mb-3">Plan</a>

            <table class="table table-success transparent-table">
                <thead>
                <tr>
                    <th scope="col">Turnus</th>
                    <th scope="col">Zabieg</th>
                    <th scope="col">Termin rozpoczęcia</th>
                    <th scope="col">Termin zakończenia</th>
                    <th></th>

                </tr>
                </thead>
                <tbody>
                {% set currentTurnus = null %}
                {% for data in plan_data %}
                    {% if currentTurnus != data.getRehabilitationStay().getName() %}
                        <tr class="turnus-header">
                            <td>
                                <a href="{{ path('rehabilitation_stay_show', {'id': data.getRehabilitationStay().getId()}) }}">
                                    {{ data.getRehabilitationStay().getName() }}
                                </a>
                            </td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td>
                                <a class="btn btn-success" href="{{ path('treatment_plan_create', {'id': data.getRehabilitationStay().getId()}) }}">
                                    Dodaj zabieg
                                </a>
                            </td>

                        </tr>
                        {% set currentTurnus = data.getRehabilitationStay().getName() %}
                    {% endif %}
                    <tr class="turnus-details">
                        <td></td>
                        <td>
                            <a href="{{ path('treatment_show', {'id': data.getTreatment().getId()}) }}">
                                {{ data.getTreatment().getName() }}
                            </a>
                        </td>
                        <td>{{ data.getStartTime()|date('d-m-Y H:i:s') }}</td>
                        <td>{{ data.getEndTime()|date('d-m-Y H:i:s') }}</td>
                        <td></td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>

        </section>
    </main>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function () {
            $('.turnus-header').click(function () {
                $(this).nextUntil('.turnus-header').toggleClass('collapsed');
            });
        });
    </script>

{% endblock %}
